define(["config/BaseConfig",],function(a){var b=function(g){var f={};var h={data:null,videos:null,screenshot:null};$.extend(h,g);function d(){e();c()}function e(){var j=$(h.data);var k=j.find("presentation > videoplaylist").first().find("video");var i={};i.duration=0;i.length=k.length;$.each(k,function(m,o){var n=$(j.find('fsxml > video[fullid|="'+$(o).attr("referid")+'"]'));var l={};l.starttime=!$(o).find("starttime").text()?0:parseFloat($(o).find("starttime").text());l.duration=!$(o).find("duration").text()?-1:parseFloat($(o).find("duration").text());l.position=m;l.sources=[];var p=0;if(n.children("rawvideo").length>0){$.each(n.children("rawvideo"),function(t,u){u=$(u);if((!u.find("original").text()&&u.find("wantedheight").text()!=="")||n.children("rawvideo").length===1){var x=false;var w=$.grep(l.sources,function(y){return y.quality==(u.find("wantedheight").text())});if(w===null){x=true;w={}}w.quality=u.find("height").text()+"p";if(w.codecs===undefined){w.codecs=[]}var v={};switch(u.find("extension").text()){case"mp4":v.type="video/mp4"}var q=u.find("mount").text().split(",")[0];var s=u.find("filename").length==0?"raw.mp4":u.find("filename").text();if(a.streamURI){v.src="http://"+u.find("mount").text()+a.streamURI+u.find("mount").text()+"/"+n.attr("fullid")+"/rawvideo/"+u.attr("id")+"/"+s}else{v.src=a.baseURI+"/rafael"+n.attr("fullid")+"/rawvideo/"+u.attr("id")+"/"+s}var r=n.attr("fullid");w.codecs.push(v);l.sources.push(w);p=u.find("duration").text()!==""?parseFloat(u.find("duration").text())*1000:p;l.oduration=p}})}i[m]=l;i.duration=l.duration==-1?i.duration+p:i.duration+l.duration});h.videos=i}function c(){var l=$(h.data);var i=l.find("presentation > videoplaylist").first().find("video").first();var p=!$(i).find("starttime").text()?0:$(i).find("starttime").text();var q=$(l.find('fsxml > video[fullid|="'+i.attr("referid")+'"]'));var r=q.find("screens");var j=r.find("properties > uri").text();j=j.replace("http://.noterik.com",a.baseURI+"/stills");var m=Math.floor(parseInt(p)/1000)+10;var n=Math.floor(m/3600);var k=Math.floor((m%3600)/60);var o=Math.floor((m%3600)%60);h.screenshot=j+"/h/"+n+"/m/"+k+"/sec"+o+".jpg"}f.getVideos=function(){return h.videos};f.getScreenshot=function(){return h.screenshot};d();return f};return b});