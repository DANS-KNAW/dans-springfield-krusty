define(["config/BaseConfig",],function(a){var b=function(g){var f={};var h={data:null,videos:null,screenshot:null};$.extend(h,g);function d(){e();c()}function e(){var j=$(h.data);var k=j.find("presentation > videoplaylist").first().find("video");var i={};i.duration=0;i.length=k.length;$.each(k,function(m,o){var n=$(j.find('fsxml > video[fullid|="'+$(o).attr("referid")+'"]'));var l={};l.starttime=!$(o).find("starttime").text()?0:parseFloat($(o).find("starttime").text());l.duration=!$(o).find("duration").text()?-1:parseFloat($(o).find("duration").text());l.position=m;l.sources=[];var p=0;if(n.children("rawvideo").length>0){$.each(n.children("rawvideo"),function(s,t){t=$(t);if((!t.find("original").text()&&t.find("wantedheight").text()!=="")||n.children("rawvideo").length===1){var w=false;var v=$.grep(l.sources,function(x){return x.quality==(t.find("wantedheight").text())});if(v===null){w=true;v={}}v.quality=t.find("height").text()+"p";if(v.codecs===undefined){v.codecs=[]}var u={};switch(t.find("extension").text()){case"mp4":u.type="video/mp4"}var q=t.find("mount").text().split(",")[0];u.src=a.baseURI+"/rafael/"+n.attr("fullid")+"/rawvideo/"+t.attr("id")+"/"+t.find("filename").text();var r=n.attr("fullid");v.codecs.push(u);l.sources.push(v);p=t.find("duration").text()!==""?parseFloat(t.find("duration").text())*1000:p;l.oduration=p}})}i[m]=l;i.duration=l.duration==-1?i.duration+p:i.duration+l.duration});h.videos=i}function c(){var l=$(h.data);var i=l.find("presentation > videoplaylist").first().find("video").first();var p=!$(i).find("starttime").text()?0:$(i).find("starttime").text();var q=$(l.find('fsxml > video[fullid|="'+i.attr("referid")+'"]'));var r=q.find("screens");var j=r.find("properties > uri").text();j=j.replace(".noterik.com",a.baseURI+"/stills");var m=Math.floor(parseInt(p)/1000)+10;var n=Math.floor(m/3600);var k=Math.floor((m%3600)/60);var o=Math.floor((m%3600)%60);h.screenshot=j+"/h/"+n+"/m/"+k+"/sec"+o+".jpg"}f.getVideos=function(){return h.videos};f.getScreenshot=function(){return h.screenshot};d();return f};return b});